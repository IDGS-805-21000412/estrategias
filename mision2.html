<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agencia Secreta de Libros - Misi√≥n 2</title>
    <link rel="stylesheet" href="css/styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Comic+Neue:wght@700&family=Fredoka+One&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <section id="mission2">
            <div class="mission">
                <h2>MISI√ìN 2: ‚ÄúOperaci√≥n Pulsera Dorada‚Äù</h2>
                <p><span style="color: green;"><strong>Nivel:</strong> Intermedio</span></p>

                <div class="mission-text">
                    <p><strong>Instrucciones para el agente lector:</strong></p>
                    <p>Leer la historia <em>‚ÄúLa pulsera‚Äù</em> y resolver los desaf√≠os ocultos para descubrir el verdadero valor de las cosas.</p>
                    
                    <a href="pdf/LA PULSERA.pdf" target="_blank" class="pdf-btn">üìñ Leer "La pulsera"</a>
                    
                    <h3>Reto 1: Memoria secreta</h3>
                    <p>Ordena los siguientes eventos en la secuencia correcta arrastrando las tarjetas a los espacios en blanco:</p>

                    <div class="sequence-cards" id="originalCards">
                        <div class="event-card" draggable="true" data-order="1">La ni√±a observa durante d√≠as la pulsera en el escaparate.</div>
                        <div class="event-card" draggable="true" data-order="2">La ni√±a entra a la joyer√≠a.</div>
                        <div class="event-card" draggable="true" data-order="3">El joyero envuelve la pulsera para regalo.</div>
                        <div class="event-card" draggable="true" data-order="4">La ni√±a entrega todo lo que tiene para pagarla.</div>
                        <div class="event-card" draggable="true" data-order="5">La madre regresa con la pulsera al d√≠a siguiente.</div>
                    </div>

                    <h3>Ordena las tarjetas aqu√≠:</h3>
                    <div class="sequence-slots" id="dropSlots">
                        <div class="sequence-slot" data-slot="1"></div>
                        <div class="sequence-slot" data-slot="2"></div>
                        <div class="sequence-slot" data-slot="3"></div>
                        <div class="sequence-slot" data-slot="4"></div>
                        <div class="sequence-slot" data-slot="5"></div>
                    </div>

                    <button class="btn" id="checkSequence">Verificar secuencia</button>
                    <div class="sequence-feedback" id="feedback"></div>
                </div>
            </div>
            
            <div class="mission-button-container">
    <a href="mision2.html">
        <button class="btn">Ir a la Misi√≥n 3</button>
    </a>
</div>
        </section>
    </div>

    <div class="reward-alert" id="rewardAlert">
        <div class="reward-content">
            <h2 class="reward-title">¬°Felicidades, has ganado!</h2>
            <p class="reward-subtitle">Recompensa de agente:</p>
            <img src="img/recompensa2.png" alt="Personaje desbloqueado" class="reward-character">
            <button class="reward-btn" id="closeReward">¬°Aceptar recompensa!</button>
        </div>
    </div>

    <div class="confetti-container" id="confettiContainer"></div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const originalCards = document.getElementById('originalCards');
            const dropSlots = document.getElementById('dropSlots');
            const checkSequenceBtn = document.getElementById('checkSequence');
            const feedback = document.getElementById('feedback');
            const rewardAlert = document.getElementById('rewardAlert');
            const closeRewardBtn = document.getElementById('closeReward');
            const nextMissionBtn = document.getElementById('nextMissionBtn');
            const confettiContainer = document.getElementById('confettiContainer');
            
            let draggedCard = null;

            // Hacer las tarjetas arrastrables
            document.querySelectorAll('.event-card').forEach(card => {
                card.addEventListener('dragstart', function() {
                    draggedCard = this;
                    setTimeout(() => {
                        this.classList.add('dragging');
                    }, 0);
                });

                card.addEventListener('dragend', function() {
                    this.classList.remove('dragging');
                });
            });

            // Configurar las √°reas de destino
            document.querySelectorAll('.sequence-slot').forEach(slot => {
                slot.addEventListener('dragover', function(e) {
                    e.preventDefault();
                    this.classList.add('highlight');
                });

                slot.addEventListener('dragleave', function() {
                    this.classList.remove('highlight');
                });

                slot.addEventListener('drop', function(e) {
                    e.preventDefault();
                    this.classList.remove('highlight');
                    
                    // Si ya hay una tarjeta en este espacio, devolverla al √°rea original
                    if (this.firstChild) {
                        originalCards.appendChild(this.firstChild);
                    }
                    
                    // Colocar la tarjeta arrastrada en el espacio
                    if (draggedCard) {
                        this.appendChild(draggedCard);
                    }
                });
            });

            // Verificar la secuencia
            checkSequenceBtn.addEventListener('click', function() {
                let isCorrect = true;
                const slots = document.querySelectorAll('.sequence-slot');
                
                slots.forEach((slot, index) => {
                    const card = slot.querySelector('.event-card');
                    if (!card || card.dataset.order != (index + 1)) {
                        isCorrect = false;
                    }
                });
                
                if (isCorrect) {
                    feedback.textContent = '¬°Secuencia correcta! Has completado el reto.';
                    feedback.className = 'sequence-feedback correct';
                    
                    // Mostrar recompensa
                    rewardAlert.classList.add('show');
                    launchConfetti();
                    
                    // Habilitar bot√≥n para siguiente misi√≥n
                    nextMissionBtn.disabled = false;
                } else {
                    feedback.textContent = 'La secuencia no es correcta. Int√©ntalo de nuevo.';
                    feedback.className = 'sequence-feedback incorrect';
                }
            });
            
            // Cerrar la alerta de recompensa
            closeRewardBtn.addEventListener('click', function() {
                rewardAlert.classList.remove('show');
            });
            
            // Funci√≥n para lanzar confeti
            function launchConfetti() {
                for (let i = 0; i < 100; i++) {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.left = Math.random() * 100 + 'vw';
                    confetti.style.backgroundColor = `hsl(${Math.random() * 360}, 100%, 50%)`;
                    confetti.style.animationDuration = (Math.random() * 3 + 2) + 's';
                    confettiContainer.appendChild(confetti);
                    
                    // Eliminar el confeti despu√©s de la animaci√≥n
                    setTimeout(() => {
                        confetti.remove();
                    }, 5000);
                }
            }
        });
    </script>
</body>
</html>